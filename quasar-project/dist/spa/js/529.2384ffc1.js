"use strict";(globalThis["webpackChunkkao"]=globalThis["webpackChunkkao"]||[]).push([[529],{1569:(e,o,t)=>{t.d(o,{hi:()=>n});var r=t(3340),a=t(8329);const n=a.ZP.create({baseURL:"https://world.openfoodfacts.org/"});(0,r.xr)((({app:e})=>{e.config.globalProperties.$axios=a.ZP,e.config.globalProperties.$api=n}))},9529:(e,o,t)=>{t.r(o),t.d(o,{default:()=>P});var r=t(9835),a=t(6970),n=t(1957);const i={class:"row justify-center q-pa-md"},s={class:"text-weight-light text-center",style:{"margin-top":"0.5em !important"}},c={class:"full-width"},d=["src"],l={class:"row justify-center q-pa-md"},p={class:"text-weight-light text-center",style:{"margin-bottom":"0.05em !important","padding-bottom":"0.05em !important","margin-top":"0.5em !important"}},m={class:"row justify-center q-pa-md",style:{"margin-top":"0 !important","padding-top":"0 !important"}};function u(e,o,t,u,g,h){const b=(0,r.up)("StreamBarcodeReader"),w=(0,r.up)("q-btn"),y=(0,r.up)("q-input"),R=(0,r.up)("q-page");return(0,r.wg)(),(0,r.j4)(R,{class:"flex-center q-pa-md"},{default:(0,r.w5)((()=>[(0,r._)("div",i,[(0,r._)("h5",s,(0,a.zw)(e.$t("Scan the barcode...")),1),(0,r._)("div",c,[e.$q.platform.is.desktop?((0,r.wg)(),(0,r.j4)(b,{key:0,onDecode:e.onDecode,onLoaded:e.onLoaded,onInit:e.onInit},null,8,["onDecode","onLoaded","onInit"])):(0,r.kq)("",!0)]),e.$q.platform.is.mobile?((0,r.wg)(),(0,r.iD)("img",{key:0,alt:"KAO logo",src:e.$q.dark.isActive?"barcodes/barcode-dark.png":"barcodes/barcode-light.png",style:{"margin-top":"0",width:"75%","margin-bottom":"4em"}},null,8,d)):(0,r.kq)("",!0),e.$q.platform.is.mobile?((0,r.wg)(),(0,r.j4)(w,{key:1,rounded:"",color:"primary",icon:"qr_code_scanner",label:"Mobile Barcode Scanner",onClick:e.scanImage},null,8,["onClick"])):(0,r.kq)("",!0)]),(0,r._)("div",l,[(0,r._)("h5",p,(0,a.zw)(e.$t("...or enter numbers below")),1)]),(0,r._)("div",m,[(0,r.Wm)(y,{type:"number",min:"0",rounded:"",outlined:"",modelValue:e.barcode,"onUpdate:modelValue":o[0]||(o[0]=o=>e.barcode=o),style:{"min-width":"20em !important"},onKeydown:o[1]||(o[1]=(0,n.D2)((0,n.iM)((o=>e.submit()),["prevent"]),["enter"]))},null,8,["modelValue"])])])),_:1})}t(9665);var g=t(499),h=t(3906),b=t(1569),w=t(6827);const y=(0,r.aZ)({name:"SearchPage",components:{StreamBarcodeReader:h.w},data(){return{result:"",error:""}},setup(){return{barcode:(0,g.iH)("")}},methods:{submit(){let e,o=this;b.hi.get(`api/v2/product/${this.barcode}`).then((o=>{e=Object.values(o.data)})).catch((()=>{w.Z.create({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})})),w.Z.create({spinner:!0,message:"Please wait...",timeout:1600}),setTimeout((()=>{e?null==e[0]?w.Z.create({color:"negative",position:"top",message:"Product not found",icon:"report_problem"}):(e=e[1],o.$router.push({path:"/product/details",query:{barcode:JSON.stringify(e)}})):w.Z.create({color:"negative",position:"top",message:"Product not found",icon:"report_problem"})}),1950)},onDecode(e,o,t){this.barcode!==e&&(this.barcode=e,this.submit()),console.log(e+""+o+t)},async onInit(e){try{await e}catch(o){"NotAllowedError"===o.name?this.error="ERROR: you need to grant camera access permisson":"NotFoundError"===o.name?this.error="ERROR: no camera on this device":"NotSupportedError"===o.name?this.error="ERROR: secure context required (HTTPS, localhost)":"NotReadableError"===o.name?this.error="ERROR: is the camera already in use?":"OverconstrainedError"===o.name?this.error="ERROR: installed cameras are not suitable":"StreamApiNotSupportedError"===o.name&&(this.error="ERROR: Stream API is not supported in this browser")}},onLoaded(){console.log("load")},scanImage(){cordova.plugins.barcodeScanner.scan((e=>{this.barcode=e.text,this.submit()}),(e=>{alert("Scanning failed: "+e)}),{preferFrontCamera:!1,showFlipCameraButton:!0,showTorchButton:!0,torchOn:!1,saveHistory:!1,prompt:"Place a barcode inside the scan area",resultDisplayDuration:500,orientation:"portrait",disableAnimations:!0,disableSuccessBeep:!0})}}});var R=t(1639),f=t(9885),v=t(4455),k=t(6611),q=t(9984),S=t.n(q);const E=(0,R.Z)(y,[["render",u]]),P=E;S()(y,"components",{QPage:f.Z,QBtn:v.Z,QInput:k.Z})}}]);